{"version":3,"sources":["src/PivotTableUI.jsx"],"names":["HelpConstants","DraggableAttribute","props","state","open","filterText","showTooltip","nextProps","nextContext","Object","keys","valueFilter","length","isSelected","removeValuesFromFilter","name","value","addValuesToFilter","x","toLowerCase","trim","includes","e","stopPropagation","setValuesInFilter","attrValues","filter","y","showMenu","menuLimit","values","shown","matchesFilter","bind","sort","sorter","display","cursor","zIndex","moveFilterBoxToTop","setState","code","charCode","keyCode","target","map","toggleValue","replace","chevronClass","filtered","searchMatched","hideTooltips","showTooltips","cols","indexOf","onUpdateProperties","$set","item","rows","toggleFilterBox","getFilterBox","React","Component","defaultProps","propTypes","PropTypes","string","isRequired","func","clearFilters","objectOf","number","bool","Dropdown","toggle","current","r","setValue","onSearchChange","s","PureComponent","PivotTableUI","unusedOrder","zIndices","maxZIndex","openDropdown","materializeInput","data","nextData","materializedInput","recordsProcessed","PivotData","forEachRecord","derivedAttributes","record","push","attr","null","command","onChange","key","sendPropUpdate","attribute","reduce","v","$unset","dropdown","items","classes","categories","undefined","selectedList","concat","collapsibles","draggables","category","sorters","searchFoundAttrs","closedClass","searchFoundCats","openedClass","group","ghostClass","preventOnFilter","numValsAllowed","aggregators","aggregatorName","numInputs","rendererName","renderers","rendererCell","isOpen","propUpdater","sortIcons","key_a_to_z","rowSymbol","colSymbol","next","value_a_to_z","value_z_to_a","aggregatorCell","SORT_ROWS","rowOrder","SORT_COLUMNS","colOrder","unusedAttrs","hiddenAttributes","hiddenFromDragDrop","unusedLength","horizUnused","unusedOrientationCutoff","unusedAttrsCell","makeDnDCell","order","categoryToAttrMapping","colAttrs","colAttrsCell","rowAttrs","rowAttrsCell","outputCell","assign","PivotTable","arrayOf","hiddenFromAggregators"],"mappings":"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","file":"PivotTableUI.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport {PivotData, sortAs, getSort} from './Utilities';\nimport PivotTable from './PivotTable';\nimport Sortable from 'react-sortablejs';\nimport Draggable from 'react-draggable';\nimport Collapsible from 'react-collapsible';\nimport SearchFilter from \"./SearchFilterView\";\nimport Tooltip from 'react-tooltip-lite';\nimport Checkbox from '@material/react-checkbox';\nimport MaterialIcon from '@material/react-material-icon';\nimport * as HelpConstants from './HelpConstants';\n\nimport \"@material/react-checkbox/dist/checkbox.css\";\nimport '@material/react-material-icon/dist/material-icon.css'\n\n/* eslint-disable react/prop-types */\n// eslint can't see inherited propTypes!\n\nexport class DraggableAttribute extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {open: false, filterText: '', showTooltip : false};\n  }\n  componentWillReceiveProps(nextProps, nextContext) {\n    if(Object.keys(this.props.valueFilter).length > 0 && !nextProps.isSelected) {\n      this.props.removeValuesFromFilter(this.props.name, Object.keys(this.props.valueFilter));\n    }\n  }\n\n  toggleValue(value) {\n    if (value in this.props.valueFilter) {\n      this.props.removeValuesFromFilter(this.props.name, [value]);\n    } else {\n      this.props.addValuesToFilter(this.props.name, [value]);\n    }\n  }\n\n  matchesFilter(x) {\n    return x\n      .toLowerCase()\n      .trim()\n      .includes(this.state.filterText.toLowerCase().trim());\n  }\n\n  selectOnly(e, value) {\n    e.stopPropagation();\n    this.props.setValuesInFilter(\n      this.props.name,\n      Object.keys(this.props.attrValues).filter(y => y !== value)\n    );\n  }\n\n  getFilterBox() {\n    const showMenu =\n      Object.keys(this.props.attrValues).length < this.props.menuLimit;\n\n    const values = Object.keys(this.props.attrValues);\n    const shown = values\n      .filter(this.matchesFilter.bind(this))\n      .sort(this.props.sorter);\n    return (\n      <Draggable handle=\".pvtDragHandle\">\n        <div\n          className=\"pvtFilterBox\"\n          style={{\n            display: 'block',\n            cursor: 'initial',\n            zIndex: this.props.zIndex\n          }}\n          onClick={() => this.props.moveFilterBoxToTop(this.props.name)}\n        >\n          <a onClick={() => this.setState({open: false})} className=\"pvtCloseX\">\n            ×\n          </a>\n          <span className=\"pvtDragHandle\">⠿</span>\n          <h4>{this.props.name}</h4>\n\n\n          {showMenu || <p>(too many values to show)</p>}\n\n          {showMenu && (\n            <p>\n              <input\n                type=\"text\"\n                placeholder=\"Filter values\"\n                className=\"pvtSearch\"\n                value={this.state.filterText}\n                onKeyUp={ e => {\n                  let code = e.charCode || e.keyCode;\n                  if(code === 27 && this.state.filterText === \"\"){\n                    this.setState({open: false});\n                  } else if (code === 27) {\n                    this.setState({\n                      filterText: \"\",\n                    })\n                  } \n                }}\n                onChange={e =>\n                  this.setState({\n                    filterText: e.target.value,\n                  })\n                }\n              />\n              <br />\n              <a\n                role=\"button\"\n                className=\"pvtButton\"\n                onClick={() =>\n                  this.props.removeValuesFromFilter(\n                    this.props.name,\n                    Object.keys(this.props.attrValues).filter(\n                      this.matchesFilter.bind(this)\n                    )\n                  )\n                }\n              >\n                Select {values.length === shown.length ? 'All' : shown.length}\n              </a>{' '}\n              <a\n                role=\"button\"\n                className=\"pvtButton\"\n                onClick={() =>\n                  this.props.addValuesToFilter(\n                    this.props.name,\n                    Object.keys(this.props.attrValues).filter(\n                      this.matchesFilter.bind(this)\n                    )\n                  )\n                }\n              >\n                Deselect {values.length === shown.length ? 'All' : shown.length}\n              </a>\n            </p>\n          )}\n\n          {showMenu && (\n            <div className=\"pvtCheckContainer\">\n              {shown.map(x => (\n                <p\n                  key={x}\n                  onClick={() => this.toggleValue(x)}\n                  className={x in this.props.valueFilter ? '' : 'selected'}\n                >\n                  <Checkbox\n                    nativeControlId={x.replace(' ','').toLowerCase()}\n                    checked={x in this.props.valueFilter ? false : true }\n                    onChange={(e) => this.toggleValue(x)}\n                  />\n\n                  <label htmlFor={x.replace(' ','').toLowerCase()}>{x === '' ? <em>null</em> : x}</label>\n                </p>\n              ))}\n            </div>\n          )}\n        </div>\n      </Draggable>\n    );\n  }\n\n  toggleFilterBox() {\n    this.setState({ open: !this.state.open});\n    this.props.moveFilterBoxToTop(this.props.name);\n  }\n\n  hideTooltips(){\n    this.setState({ showTooltip: false});\n  }\n\n  showTooltips(){\n    this.setState({ showTooltip: true});\n  }\n\n\n  render() {\n    let chevronClass = (this.state.open === false) ? \"pvt-attr-chevron-down\" : \"pvt-attr-chevron-up\";\n    chevronClass += (this.props.isSelected === false) ? \" pvt-attr-close-hidden\" : \" pvt-attr-close-visible\";\n    const filtered =\n      Object.keys(this.props.valueFilter).length !== 0\n        ?  (<span className= {(this.props.isSelected === false) ? \"pvtTriangleHide\" : \"pvtTriangle\"}>\n          <MaterialIcon icon=\"filter_list\" className=\"pvtIcon\"/></span>)\n        : (<span></span>);\n    return (\n      <li data-id={this.props.name}>\n        <span className={this.props.searchMatched ? \"pvtAttr pvtSearchFoundAttr\" : \"pvtAttr\"}\n              onDrag={this.hideTooltips.bind(this)} onMouseOver={this.showTooltips.bind(this)}\n              onMouseLeave={this.hideTooltips.bind(this)} onDrop={this.showTooltips.bind(this)}>\n          <Tooltip content={this.props.name} hoverDelay={200} useHover={this.state.showTooltip}>\n          <div className=\"pvt-braille-pattern\">⠿</div>\n          <div className=\"pvt-attr-container\">\n            <div className={(this.props.isSelected === false) ? \"pvt-attr-text-container-left\" : \"pvt-attr-text-container\"}\n                 data-tip={this.props.name}>{filtered} {this.props.name}\n            </div>\n            <span\n              className={(this.props.isSelected === false) ? \"pvt-attr-close-hidden\" : \"pvt-attr-close-visible\"}\n              onClick={ ()=> {\n\n                if (this.props.cols.indexOf(this.props.name) !== -1) {\n                  this.props.onUpdateProperties(\n                    {\n                      cols: {$set: this.props.cols.filter( (item) => { return item !== this.props.name})}\n                    }\n                    );\n                } else if (this.props.rows.indexOf(this.props.name) !== -1) {\n                  this.props.onUpdateProperties(\n                    {\n                      rows: {$set: this.props.rows.filter( (item) => { return item !== this.props.name})}\n                    }\n                    );\n                }\n              }}\n            >\n              {'   '}\n              ✕\n            </span>\n            <span className={chevronClass} onClick={this.toggleFilterBox.bind(this)}>▾</span> \n          </div>\n          </Tooltip>\n        </span>\n        {this.state.open ? this.getFilterBox() : null}\n      </li>\n    );\n  }\n}\n\nDraggableAttribute.defaultProps = {\n  valueFilter: {},\n  searchMatched: false\n};\n\nDraggableAttribute.propTypes = {\n  name: PropTypes.string.isRequired,\n  addValuesToFilter: PropTypes.func.isRequired,\n  removeValuesFromFilter: PropTypes.func.isRequired,\n  clearFilters: PropTypes.func.isRequired,\n  attrValues: PropTypes.objectOf(PropTypes.number).isRequired,\n  valueFilter: PropTypes.objectOf(PropTypes.bool),\n  moveFilterBoxToTop: PropTypes.func.isRequired,\n  sorter: PropTypes.func.isRequired,\n  searchMatched: PropTypes.objectOf(PropTypes.bool),\n  menuLimit: PropTypes.number,\n  zIndex: PropTypes.number,\n};\n\nexport class Dropdown extends React.PureComponent {\n  render() {\n    return (\n      <div className=\"pvtDropdown\" style={{zIndex: this.props.zIndex}}>\n        <div className=\"pvtLabel\">Visualization Format</div>\n        <div\n          onClick={e => {\n            e.stopPropagation();\n            this.props.toggle();\n          }}\n          className={\n            'pvtDropdownValue pvtDropdownCurrent ' +\n            (this.props.open ? 'pvtDropdownCurrentOpen' : '')\n          }\n          role=\"button\"\n        >\n          <div className={this.props.open ? \"pvtDropdownIconOpen\" : \"pvtDropdownIcon\"} >▾</div>\n          {this.props.current || <span>&nbsp;</span>}\n        </div>\n\n        {this.props.open && (\n          <div className=\"pvtDropdownMenu\">\n            {this.props.values.map(r => (\n              <div\n                key={r}\n                role=\"button\"\n                onClick={e => {\n                  e.stopPropagation();\n                  if (this.props.current === r) {\n                    this.props.toggle();\n                  } else {\n                    this.props.setValue(r);\n                  }\n                }}\n                className={\n                  'pvtDropdownValue2 ' +\n                  (r === this.props.current ? 'pvtDropdownActiveValue' : '')\n                }\n              >\n                {r}\n              </div>\n            ))}\n          </div>\n        )}\n        <br/>\n        <SearchFilter onSearchChange={s => {\n          this.onSearchChange(s)\n        }}/>\n      </div>\n    );\n  }\n\n  onSearchChange (s) {\n    this.props.onSearchChange(s);\n  }\n\n}\n\nclass PivotTableUI extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      unusedOrder: [],\n      zIndices: {},\n      maxZIndex: 1000,\n      openDropdown: false,\n    };\n  }\n\n  componentWillMount() {\n    this.materializeInput(this.props.data);\n  }\n\n  componentWillUpdate(nextProps) {\n    this.materializeInput(nextProps.data);\n  }\n\n  materializeInput(nextData) {\n    if (this.data === nextData) {\n      return;\n    }\n    this.data = nextData;\n    const attrValues = {};\n    const materializedInput = [];\n    let recordsProcessed = 0;\n    PivotData.forEachRecord(this.data, this.props.derivedAttributes, function(\n      record\n    ) {\n      materializedInput.push(record);\n      for (const attr of Object.keys(record)) {\n        if (!(attr in attrValues)) {\n          attrValues[attr] = {};\n          if (recordsProcessed > 0) {\n            attrValues[attr].null = recordsProcessed;\n          }\n        }\n      }\n      for (const attr in attrValues) {\n        const value = attr in record ? record[attr] : 'null';\n        if (!(value in attrValues[attr])) {\n          attrValues[attr][value] = 0;\n        }\n        attrValues[attr][value]++;\n      }\n      recordsProcessed++;\n    });\n\n    this.materializedInput = materializedInput;\n    this.attrValues = attrValues;\n  }\n\n  sendPropUpdate(command) {\n    this.props.onChange(update(this.props, command));\n  }\n\n  propUpdater(key) {\n    return value => this.sendPropUpdate({[key]: {$set: value}});\n  }\n\n  setValuesInFilter(attribute, values) {\n    this.sendPropUpdate({\n      valueFilter: {\n        [attribute]: {\n          $set: values.reduce((r, v) => {\n            r[v] = true;\n            return r;\n          }, {}),\n        },\n      },\n    });\n  }\n\n  addValuesToFilter(attribute, values) {\n    if (attribute in this.props.valueFilter) {\n      this.sendPropUpdate({\n        valueFilter: {\n          [attribute]: values.reduce((r, v) => {\n            r[v] = {$set: true};\n            return r;\n          }, {}),\n        },\n      });\n    } else {\n      this.setValuesInFilter(attribute, values);\n    }\n  }\n\n  removeValuesFromFilter(attribute, values) {\n      this.sendPropUpdate({\n        valueFilter: {[attribute]: {$unset: values}},\n      });\n\n  }\n\n  clearFilters(attribute) {\n    this.sendPropUpdate({\n      valueFilter: {[attribute]: {0 : 0}},\n    });\n  }\n\n  moveFilterBoxToTop(attribute) {\n    this.setState(\n      update(this.state, {\n        maxZIndex: {$set: this.state.maxZIndex + 1},\n        zIndices: {[attribute]: {$set: this.state.maxZIndex + 1}},\n      })\n    );\n  }\n\n  isOpen(dropdown) {\n    return this.state.openDropdown === dropdown;\n  }\n\n  makeDnDCell(items, onChange, classes, categories = undefined) {\n\n    const selectedList = this.props.cols.concat(this.props.rows)\n\n    let collapsibles = [], draggables;\n    if (categories) {\n      for(let category in categories) {\n\n        draggables = [];\n        items.map(x => {\n          if (categories[category].includes(x)) {\n            draggables.push(<DraggableAttribute\n              name={x}\n              key={x}\n              attrValues={this.attrValues[x]}\n              valueFilter={this.props.valueFilter[x] || {}}\n              sorter={getSort(this.props.sorters, x)}\n              menuLimit={this.props.menuLimit}\n              setValuesInFilter={this.setValuesInFilter.bind(this)}\n              addValuesToFilter={this.addValuesToFilter.bind(this)}\n              moveFilterBoxToTop={this.moveFilterBoxToTop.bind(this)}\n              removeValuesFromFilter={this.removeValuesFromFilter.bind(this)}\n              clearFilters={this.clearFilters.bind(this)}\n              zIndex={this.state.zIndices[x] || this.state.maxZIndex}\n              isSelected={selectedList.includes(x)}\n              searchMatched={this.props.searchFoundAttrs.includes(x)}\n              cols={this.props.cols}\n              rows={this.props.rows}\n              onUpdateProperties={ (s) => this.sendPropUpdate(s)}\n            />);\n          }\n        });\n        let open = Object.keys(categories)[0] === category ? true : false;\n        let closedClass = this.props.searchFoundCats.includes(category)\n          ? 'attrListClosed pvtSearchFoundCat' : 'attrListClosed';\n        let openedClass = this.props.searchFoundCats.includes(category)\n          ? 'attrListOpen pvtSearchFoundCat' : 'attrListOpen';\n        collapsibles.push(\n          <Collapsible\n            trigger={category}\n            open={open}\n            //overflowWhenOpen=\"hidden\" //Aji updated\n            className={closedClass}\n            openedClassName={openedClass}\n            triggerClassName=\"attrHeaderClosed\"\n            triggerOpenedClassName=\"attrHeaderOpen\"\n          >\n            <Sortable\n              options={{\n                group: 'shared',\n                ghostClass: 'pvtPlaceholder',\n                filter: '.pvtFilterBox',\n                preventOnFilter: false,\n              }}\n              tag=\"div\"\n              onChange={onChange}\n              className={classes}\n            >\n              {draggables}\n            </Sortable>\n          </Collapsible>);\n      }\n      return (\n        <div className=\"pvtCollapsible\">\n          {collapsibles}\n        </div>\n      )\n    } else {\n      items.map(x => {\n        collapsibles.push(\n          <DraggableAttribute\n            name={x}\n            key={x}\n            attrValues={this.attrValues[x]}\n            valueFilter={this.props.valueFilter[x] || {}}\n            sorter={getSort(this.props.sorters, x)}\n            menuLimit={this.props.menuLimit}\n            setValuesInFilter={this.setValuesInFilter.bind(this)}\n            addValuesToFilter={this.addValuesToFilter.bind(this)}\n            moveFilterBoxToTop={this.moveFilterBoxToTop.bind(this)}\n            removeValuesFromFilter={this.removeValuesFromFilter.bind(this)}\n            searchMatched={this.props.searchFoundAttrs.includes(x)}\n            clearFilters={this.clearFilters.bind(this)}\n            zIndex={this.state.zIndices[x] || this.state.maxZIndex}\n            isSelected={selectedList.includes(x)}\n            cols={this.props.cols}\n            rows={this.props.rows}\n            onUpdateProperties={ (s) => this.sendPropUpdate(s)}\n          />\n        );\n      });\n      return (\n        <Sortable\n          options={{\n            group: 'shared',\n            ghostClass: 'pvtPlaceholder',\n            filter: '.pvtFilterBox',\n            preventOnFilter: false,\n          }}\n          tag=\"td\"\n          className={classes}\n          onChange={onChange}\n        >\n          {collapsibles}\n        </Sortable>\n      )\n    }\n  }\n\n  onSearchChange (s) {\n    this.props.onSearchChange(s)\n  }\n\n  render() {\n    const numValsAllowed =\n      this.props.aggregators[this.props.aggregatorName]([])().numInputs || 0;\n\n    const rendererName =\n      this.props.rendererName in this.props.renderers\n        ? this.props.rendererName\n        : Object.keys(this.props.renderers)[0];\n\n    const rendererCell = (\n      <td className=\"pvtRenderers\">\n        <Dropdown\n          current={rendererName}\n          values={Object.keys(this.props.renderers)}\n          open={this.isOpen('renderer')}\n          zIndex={this.isOpen('renderer') ? this.state.maxZIndex + 1 : 1}\n          toggle={() =>\n            this.setState({\n              openDropdown: this.isOpen('renderer') ? false : 'renderer',\n            })\n          }\n          setValue={this.propUpdater('rendererName')}\n          onSearchChange={s => {\n            this.onSearchChange(s)\n          }}\n        />\n      </td>\n    );\n\n    const sortIcons = {\n      key_a_to_z: {\n        rowSymbol: '↕',\n        colSymbol: '↔',\n        next: 'value_a_to_z',\n      },\n      value_a_to_z: {\n        rowSymbol: '↓',\n        colSymbol: '→',\n        next: 'value_z_to_a',\n      },\n      value_z_to_a: {rowSymbol: '↑', colSymbol: '←', next: 'key_a_to_z'},\n    };\n\n    const aggregatorCell = (\n      <td className=\"pvtVals\">\n        <Tooltip content={HelpConstants.SORT_ROWS} eventOn='onClick' tagName='span'>\n          <MaterialIcon icon=\"help_outline\" className=\"pvtIconHelp\"/>\n        </Tooltip>\n        <a\n          role=\"button\"\n          className=\"pvtRowOrder\"\n          onClick={() =>\n            this.propUpdater('rowOrder')(sortIcons[this.props.rowOrder].next)\n          }\n        >\n         Sort rows {sortIcons[this.props.rowOrder].rowSymbol}\n        </a>\n        <br/>\n        <Tooltip content={HelpConstants.SORT_COLUMNS} eventOn='onClick' tagName='span'>\n          <MaterialIcon icon=\"help_outline\" className=\"pvtIconHelp\"/>\n        </Tooltip>\n        <a\n          role=\"button\"\n          className=\"pvtColOrder\"\n          onClick={() =>\n            this.propUpdater('colOrder')(sortIcons[this.props.colOrder].next)\n          }\n        >\n         Sort columns {sortIcons[this.props.colOrder].colSymbol}\n        </a>\n        {numValsAllowed > 0 && <br />}\n      </td>\n    );\n\n    const unusedAttrs = Object.keys(this.attrValues)\n      .filter(\n        e =>\n          !this.props.rows.includes(e) &&\n          !this.props.cols.includes(e) &&\n          !this.props.hiddenAttributes.includes(e) &&\n          !this.props.hiddenFromDragDrop.includes(e)\n      )\n      .sort(sortAs(this.state.unusedOrder));\n\n    const unusedLength = unusedAttrs.reduce((r, e) => r + e.length, 0);\n    const horizUnused = unusedLength < this.props.unusedOrientationCutoff;\n    const unusedAttrsCell = this.makeDnDCell(\n      unusedAttrs,\n      order => this.setState({unusedOrder: order}),\n      `pvtAxisContainer pvtUnused ${\n        horizUnused ? 'pvtHorizList' : 'pvtVertList collapsibleMenuContainer'\n      }`,\n      this.props.categoryToAttrMapping\n    );\n\n    const colAttrs = this.props.cols.filter(\n      e =>\n        !this.props.hiddenAttributes.includes(e) &&\n        !this.props.hiddenFromDragDrop.includes(e)\n    );\n\n    const colAttrsCell = this.makeDnDCell(\n      colAttrs,\n      this.propUpdater('cols'),\n      'pvtAxisContainer pvtHorizList pvtCols'\n    );\n\n    const rowAttrs = this.props.rows.filter(\n      e =>\n        !this.props.hiddenAttributes.includes(e) &&\n        !this.props.hiddenFromDragDrop.includes(e)\n    );\n    const rowAttrsCell = this.makeDnDCell(\n      rowAttrs,\n      this.propUpdater('rows'),\n      'pvtAxisContainer pvtVertList pvtRows'\n    );\n    const outputCell = (\n      <td className=\"pvtOutput\">\n        <PivotTable\n          {...update(this.props, {\n            data: {$set: this.materializedInput},\n          })}\n        />\n      </td>\n    );\n\n    if (horizUnused) {\n      return (\n        <table className=\"pvtUi\">\n          <tbody onClick={() => this.setState({openDropdown: false})}>\n            <tr>\n              {rendererCell}\n              {unusedAttrsCell}\n            </tr>\n            <tr>\n              {aggregatorCell}\n              {colAttrsCell}\n            </tr>\n            <tr>\n              {rowAttrsCell}\n              {outputCell}\n            </tr>\n          </tbody>\n        </table>\n      );\n    }\n\n    return (\n      <table className=\"pvtUi\">\n        <tbody onClick={() => this.setState({openDropdown: false})}>\n          <tr>\n            {rendererCell}\n            {aggregatorCell}\n            {colAttrsCell}\n          </tr>\n          <tr>\n            {unusedAttrsCell}\n            {rowAttrsCell}\n            {outputCell}\n          </tr>\n        </tbody>\n      </table>\n    );\n  }\n}\n\nPivotTableUI.propTypes = Object.assign({}, PivotTable.propTypes, {\n  onChange: PropTypes.func.isRequired,\n  hiddenAttributes: PropTypes.arrayOf(PropTypes.string),\n  hiddenFromAggregators: PropTypes.arrayOf(PropTypes.string),\n  hiddenFromDragDrop: PropTypes.arrayOf(PropTypes.string),\n  unusedOrientationCutoff: PropTypes.number,\n  menuLimit: PropTypes.number,\n  searchFoundAttrs: PropTypes.arrayOf(PropTypes.string),\n  searchFoundCats: PropTypes.arrayOf(PropTypes.string)\n});\n\nPivotTableUI.defaultProps = Object.assign({}, PivotTable.defaultProps, {\n  hiddenAttributes: [],\n  hiddenFromAggregators: [],\n  hiddenFromDragDrop: [],\n  unusedOrientationCutoff: 85,\n  menuLimit: 500,\n  searchFoundAttrs: [],\n  searchFoundCats: []\n});\n\nexport default PivotTableUI;\n\n"]}